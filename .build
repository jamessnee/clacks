#! /bin/bash

VERBOSE=0
CLEAN=0

do_clean ()
{
  cd ../
  rm -rf build
  mkdir build
  cd build
  ln -s ../.build .build
}

print_help ()
{
  echo "Need help eh...?"
  echo "-v -- Verbose building"
  echo "-c -- Clean before building"
}

echo "*********************"
echo "BUILDING CLACKS!"
echo "*********************"

while getopts "vch" opt; do
  case "$opt" in
    v)
     VERBOSE=1
     ;;
    c)
     CLEAN=1
     ;;
    h)
     print_help
     exit
     ;;
  esac
done

if [ $CLEAN -eq 1 ]
  then
    do_clean
fi

export CC=/usr/bin/clang
export CXX=/usr/bin/clang++

echo "Running CMake..."
cmake -D_CMAKE_TOOLCHAIN_PREFIX=llvm- -G "Unix Makefiles" ..

echo "Running make..."
if [ $VERBOSE -eq 1 ]
  then
    make VERBOSE=1
else
    make
fi
